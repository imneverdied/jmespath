<html>

<head>
  <meta charset="utf-8">
</head>

<label id="TEXT">自動載入json更新下拉選單</label></br>
<select id="TEXT3" onchange="cTXT(value)" style="background-color:Orange;">下拉選單</select>
<select id="TEXT4" onchange="eSLECT(value)" style="background-color:yellow;">集數選單</select></br>
<input type="text" id="SELECT"></br>
<label id="TEXT2">333</label>
<label id="NAME_NOW" style="display:none">現在選擇的影片名稱</label>
<label id="TYPE_NOW" style="display:none">現在選擇的影片集數格式</label>
</br>



</html>
<script src="https://imneverdied.github.io/jmespath/jmespath.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
  var play_NAME = [];
	var first_EPISO = [];
	$(document).ready(function () {


		$.ajaxSetup({ cache: false });
		$.getJSON("https://imneverdied.github.io/jmespath/example.json", function (data) {
			Gdata = data;

			/* loop through array */
			$.each(data, function (index, d) {
				play_NAME.push(d.NAME);
				first_EPISO.push(d.EPISODE);
			});
			//$("#TEXT").text(play_NAME.join(''))

			//讀jsonNAME生下拉選單====
			var selection = "";
			for (i = 0; i < play_NAME.length; i++) {
				selection = selection + "<option>" + play_NAME[i] + "</option>\r\n";
			}
			var mix = "<select id =\"TEXT3\">\r\n" + selection + "</select>"
			$(TEXT3).html(mix);
			EPISODEmaker(first_EPISO[0]);
			Fsearch(play_NAME[0]);
			eSLECT("第一集");
			
			//========================
		})

	});

	function cTXT(value) {
		Fsearch(value);
	}

	function eSLECT(value) {
		var strRTN = $(NAME_NOW).text() + " " + value;
		$(TEXT2).text(strRTN);
	}


	function Fsearch(value) {
		//定義
		var F_NAME = [];
		var F_RNAME = [];
		var F_NBRTYPE = [];
		var F_PATH = [];
		var F_SEASON = [];
		var F_EPISODE = [];
		var F_EXT = [];
		var F_CC = [];

		$.ajaxSetup({ cache: false });
		$.getJSON("example.json", function (data) {
			/* loop through array */
			$.each(data, function (index, d) {

				if (value == d.NAME) //過濾資料
				{
					//取得所有欄位資料
					F_NAME.push(d.NAME);
					F_RNAME.push(d.RNAME);
					F_NBRTYPE.push(d.NBRTYPE);
					F_PATH.push(d.PATH);
					F_SEASON.push(d.SEASON);
					F_EPISODE.push(d.EPISODE);
					F_EXT.push(d.EXT);
					F_CC.push(d.CC);

					var strRTN = F_NAME[0] + F_NBRTYPE[0];
					$(NAME_NOW).text(F_NAME[0]);
					$(TYPE_NOW).text(F_NBRTYPE[0]);
					$(TEXT2).text(strRTN);
					EPISODEmaker(F_EPISODE[0]);
				}
			});
		});

	}

	function EPISODEmaker(value) {

		//讀jsonNAME生集數下拉選單========
		var selection = "";
		for (i = 0; i < value; i++) {
			selection = selection + "<option>第" + (i + 1) + "集</option>\r\n";
		}
		var mix = "<select id =\"TEXT4\">\r\n" + selection + "</select>"
		$(TEXT4).html(mix);
		//========================

	}



	$(SELECT).keyup(
		function () {
			var AAA = document.getElementById("SELECT").value;
			$(TEXT2).text(AAA);
		});




</script>
